<div id="post-quest">
    <div class="header">
        <h2> Session 4: Post-Questionnaire</h2>
        <p class="pid-eid"></p>
    </div>
    <div>Please answer all the questions below. If you don't understand a specific question or answer, feel free to ask the experimenter(s).
        <b> Please consider the experiment today.</b>
    </div>

    <div class="high-separator"></div>

    <div id="div_liking_vis">
        <span class="question-header"> To what extent are you comfortable with identifying these instances?
        </span>
        <table style="width:100%">
            <tr class="shorter-tr">
                <td style="width:200px;"> </td>
                <td class="smaller-number-font likert-hack">1</td>
                <td class="smaller-number-font likert-hack">2</td>
                <td class="smaller-number-font likert-hack">3</td>
                <td class="smaller-number-font likert-hack">4</td>
                <td class="smaller-number-font likert-hack">5</td>
                <td class="smaller-number-font likert-hack">6</td>
                <td class="smaller-number-font likert-hack">7</td>
                <td></td>
            </tr>
            <tr>
                <td class="smaller-font">Not at all comfortable</td>
                <td class="tr-background" style="border-radius:  5px 0 0 5px;">
                    <input type="radio" name="instance_comfortable" value="1">
                </td>
                <td class="tr-background">
                    <input type="radio" name="instance_comfortable" value="2">
                </td>
                <td class="tr-background">
                    <input type="radio" name="instance_comfortable" value="3">
                </td>
                <td class="tr-background">
                    <input type="radio" name="instance_comfortable" value="4">
                </td>
                <td class="tr-background">
                    <input type="radio" name="instance_comfortable" value="5">
                </td>
                <td class="tr-background">
                    <input type="radio" name="instance_comfortable" value="6">
                </td>
                <td class="tr-background" style="border-radius: 0 5px 5px 0;">
                    <input type="radio" name="instance_comfortable" value="7">
                </td>
                <td class="smaller-font likert-hack">Very comfortable</td>
            </tr>
        </table>
    </div>
    <div class="high-separator"></div>
    <div class="high-separator"></div>

    <div id="div_liking_vis">
        <span class="question-header"> Which classifier do you like the most for the tasks today?
        </span>
        <table>
            <tr>

                <td width="250px" align="center">
                    <img name="files/vis/grid" />
                </td>
                <td width="250px" align="center">
                    <img name="files/vis/tree" />
                </td>
                <td width="250px" align="center">
                    <img name="files/vis/graph" />
                </td>
                <td width="250px" align="center">
                    the one without explanation
                    <!-- <img src="modules/files/vis/" /> -->
                </td>
            </tr>
            <tr>
                <td align="center">
                    <input type="radio" name="liking_vis" value="grid" /> grid
                </td>

                <td align="center">
                    <input type="radio" name="liking_vis" value="tree" /> tree
                </td>

                <td align="center">
                    <input type="radio" name="liking_vis" value="graph" /> graph
                </td>
                <td align="center">
                    <input type="radio" name="liking_vis" value="no_vis" />
                </td>
            </tr>
        </table>
    </div>

    <div class="high-separator"></div>
    <div class="high-separator"></div>

    <div id="div_comfortable_classifier">
        <span class="question-header"> To what extent were you comfortable with each classifier in the experiment today?
        </span>
        <table>

            <tr>
                <td width="250px" align="center">
                    <img name="files/vis/grid" />
                </td>
                <td width="750px" align="center">
                    <table style="width:100%">
                        <tr class="shorter-tr">
                            <td style="width:200px;"> </td>
                            <td class="smaller-number-font likert-hack">1</td>
                            <td class="smaller-number-font likert-hack">2</td>
                            <td class="smaller-number-font likert-hack">3</td>
                            <td class="smaller-number-font likert-hack">4</td>
                            <td class="smaller-number-font likert-hack">5</td>
                            <td class="smaller-number-font likert-hack">6</td>
                            <td class="smaller-number-font likert-hack">7</td>
                            <td></td>
                        </tr>
                        <tr>
                            <td class="smaller-font">Not at all comfortable</td>
                            <td class="tr-background" style="border-radius:  5px 0 0 5px;">
                                <input type="radio" name="grid_comfortable" value="1">
                            </td>
                            <td class="tr-background">
                                <input type="radio" name="grid_comfortable" value="2">
                            </td>
                            <td class="tr-background">
                                <input type="radio" name="grid_comfortable" value="3">
                            </td>
                            <td class="tr-background">
                                <input type="radio" name="grid_comfortable" value="4">
                            </td>
                            <td class="tr-background">
                                <input type="radio" name="grid_comfortable" value="5">
                            </td>
                            <td class="tr-background">
                                <input type="radio" name="grid_comfortable" value="6">
                            </td>
                            <td class="tr-background" style="border-radius: 0 5px 5px 0;">
                                <input type="radio" name="grid_comfortable" value="7">
                            </td>
                            <td class="smaller-font likert-hack">Very comfortable</td>
                        </tr>
                    </table>
                </td>
            </tr>

            <tr height="50px"></tr>
            <tr>
                <td width="250px" align="center">
                    <img name="files/vis/tree" />
                </td>
                <td width="750px" align="center">
                    <!-- <img src="files/vis/movement-dataset"  /> -->
                    <table style="width:100%">
                        <tr class="shorter-tr">
                            <td style="width:200px;"> </td>
                            <td class="smaller-number-font likert-hack">1</td>
                            <td class="smaller-number-font likert-hack">2</td>
                            <td class="smaller-number-font likert-hack">3</td>
                            <td class="smaller-number-font likert-hack">4</td>
                            <td class="smaller-number-font likert-hack">5</td>
                            <td class="smaller-number-font likert-hack">6</td>
                            <td class="smaller-number-font likert-hack">7</td>
                            <td></td>
                        </tr>
                        <tr>
                            <td class="smaller-font">Not at all comfortable</td>
                            <td class="tr-background" style="border-radius:  5px 0 0 5px;">
                                <input type="radio" name="tree_comfortable" value="1">
                            </td>
                            <td class="tr-background">
                                <input type="radio" name="tree_comfortable" value="2">
                            </td>
                            <td class="tr-background">
                                <input type="radio" name="tree_comfortable" value="3">
                            </td>
                            <td class="tr-background">
                                <input type="radio" name="tree_comfortable" value="4">
                            </td>
                            <td class="tr-background">
                                <input type="radio" name="tree_comfortable" value="5">
                            </td>
                            <td class="tr-background">
                                <input type="radio" name="tree_comfortable" value="6">
                            </td>
                            <td class="tr-background" style="border-radius: 0 5px 5px 0;">
                                <input type="radio" name="tree_comfortable" value="7">
                            </td>
                            <td class="smaller-font likert-hack">Very comfortable</td>
                        </tr>
                    </table>
                </td>
            </tr>
            <tr height="50px"></tr>
            <tr>
                <td width="250px" align="center">
                    <img name="files/vis/graph" />
                </td>
                <td width="750px" align="center">
                    <table style="width:100%">
                        <tr class="shorter-tr">
                            <td style="width:200px;"> </td>
                            <td class="smaller-number-font likert-hack">1</td>
                            <td class="smaller-number-font likert-hack">2</td>
                            <td class="smaller-number-font likert-hack">3</td>
                            <td class="smaller-number-font likert-hack">4</td>
                            <td class="smaller-number-font likert-hack">5</td>
                            <td class="smaller-number-font likert-hack">6</td>
                            <td class="smaller-number-font likert-hack">7</td>
                            <td></td>
                        </tr>
                        <tr>
                            <td class="smaller-font">Not at all comfortable</td>
                            <td class="tr-background" style="border-radius:  5px 0 0 5px;">
                                <input type="radio" name="graph_comfortable" value="1">
                            </td>
                            <td class="tr-background">
                                <input type="radio" name="graph_comfortable" value="2">
                            </td>
                            <td class="tr-background">
                                <input type="radio" name="graph_comfortable" value="3">
                            </td>
                            <td class="tr-background">
                                <input type="radio" name="graph_comfortable" value="4">
                            </td>
                            <td class="tr-background">
                                <input type="radio" name="graph_comfortable" value="5">
                            </td>
                            <td class="tr-background">
                                <input type="radio" name="graph_comfortable" value="6">
                            </td>
                            <td class="tr-background" style="border-radius: 0 5px 5px 0;">
                                <input type="radio" name="graph_comfortable" value="7">
                            </td>
                            <td class="smaller-font likert-hack">Very comfortable</td>
                        </tr>
                    </table>
                </td>
            </tr>
            <tr height="95px"></tr>
            <tr>
                <td width="250px" align="center">
                    the one without explanation
                </td>
                <td width="750px" align="center">
                    <table style="width:100%">
                        <tr class="shorter-tr">
                            <td style="width:200px;"> </td>
                            <td class="smaller-number-font likert-hack">1</td>
                            <td class="smaller-number-font likert-hack">2</td>
                            <td class="smaller-number-font likert-hack">3</td>
                            <td class="smaller-number-font likert-hack">4</td>
                            <td class="smaller-number-font likert-hack">5</td>
                            <td class="smaller-number-font likert-hack">6</td>
                            <td class="smaller-number-font likert-hack">7</td>
                            <td></td>
                        </tr>
                        <tr>
                            <td class="smaller-font">Not at all comfortable</td>
                            <td class="tr-background" style="border-radius:  5px 0 0 5px;">
                                <input type="radio" name="no_vis_comfortable" value="1">
                            </td>
                            <td class="tr-background">
                                <input type="radio" name="no_vis_comfortable" value="2">
                            </td>
                            <td class="tr-background">
                                <input type="radio" name="no_vis_comfortable" value="3">
                            </td>
                            <td class="tr-background">
                                <input type="radio" name="no_vis_comfortable" value="4">
                            </td>
                            <td class="tr-background">
                                <input type="radio" name="no_vis_comfortable" value="5">
                            </td>
                            <td class="tr-background">
                                <input type="radio" name="no_vis_comfortable" value="6">
                            </td>
                            <td class="tr-background" style="border-radius: 0 5px 5px 0;">
                                <input type="radio" name="no_vis_comfortable" value="7">
                            </td>
                            <td class="smaller-font likert-hack">Very comfortable</td>
                        </tr>
                    </table>
                </td>
            </tr>
        </table>
    </div>


    <div class="high-separator"></div>
    <div class="high-separator"></div>

    <div id="div_comfortable_classifier">
        <span class="question-header"> To what extent did you understand each explanation in the experiment today?
        </span>
        <table>

            <tr>
                <td width="250px" align="center">
                    <img name="files/vis/grid" />
                </td>
                <td width="750px" align="center">
                    <table style="width:100%">
                        <tr class="shorter-tr">
                            <td style="width:200px;"> </td>
                            <td class="smaller-number-font likert-hack">1</td>
                            <td class="smaller-number-font likert-hack">2</td>
                            <td class="smaller-number-font likert-hack">3</td>
                            <td class="smaller-number-font likert-hack">4</td>
                            <td class="smaller-number-font likert-hack">5</td>
                            <td class="smaller-number-font likert-hack">6</td>
                            <td class="smaller-number-font likert-hack">7</td>
                            <td></td>
                        </tr>
                        <tr>
                            <td class="smaller-font">Don't understand at all</td>
                            <td class="tr-background" style="border-radius:  5px 0 0 5px;">
                                <input type="radio" name="grid_understand" value="1">
                            </td>
                            <td class="tr-background">
                                <input type="radio" name="grid_understand" value="2">
                            </td>
                            <td class="tr-background">
                                <input type="radio" name="grid_understand" value="3">
                            </td>
                            <td class="tr-background">
                                <input type="radio" name="grid_understand" value="4">
                            </td>
                            <td class="tr-background">
                                <input type="radio" name="grid_understand" value="5">
                            </td>
                            <td class="tr-background">
                                <input type="radio" name="grid_understand" value="6">
                            </td>
                            <td class="tr-background" style="border-radius: 0 5px 5px 0;">
                                <input type="radio" name="grid_understand" value="7">
                            </td>
                            <td class="smaller-font likert-hack">Fully understand</td>
                        </tr>
                    </table>
                </td>
            </tr>
            <tr height="50px"></tr>
            <tr>
                <td width="250px" align="center">
                    <img name="files/vis/tree" />
                </td>
                <td width="750px" align="center">
                    <table style="width:100%">
                        <tr class="shorter-tr">
                            <td style="width:200px;"> </td>
                            <td class="smaller-number-font likert-hack">1</td>
                            <td class="smaller-number-font likert-hack">2</td>
                            <td class="smaller-number-font likert-hack">3</td>
                            <td class="smaller-number-font likert-hack">4</td>
                            <td class="smaller-number-font likert-hack">5</td>
                            <td class="smaller-number-font likert-hack">6</td>
                            <td class="smaller-number-font likert-hack">7</td>
                            <td></td>
                        </tr>
                        <tr>
                            <td class="smaller-font">Don't understand at all</td>
                            <td class="tr-background" style="border-radius:  5px 0 0 5px;">
                                <input type="radio" name="tree_understand" value="1">
                            </td>
                            <td class="tr-background">
                                <input type="radio" name="tree_understand" value="2">
                            </td>
                            <td class="tr-background">
                                <input type="radio" name="tree_understand" value="3">
                            </td>
                            <td class="tr-background">
                                <input type="radio" name="tree_understand" value="4">
                            </td>
                            <td class="tr-background">
                                <input type="radio" name="tree_understand" value="5">
                            </td>
                            <td class="tr-background">
                                <input type="radio" name="tree_understand" value="6">
                            </td>
                            <td class="tr-background" style="border-radius: 0 5px 5px 0;">
                                <input type="radio" name="tree_understand" value="7">
                            </td>
                            <td class="smaller-font likert-hack">Fully understand</td>
                        </tr>
                    </table>
                </td>
            </tr>
            <tr height="50px"></tr>
            <tr>
                <td width="250px" align="center">
                    <img name="files/vis/graph" />
                </td>
                <td width="750px" align="center">
                    <table style="width:100%">
                        <tr class="shorter-tr">
                            <td style="width:200px;"> </td>
                            <td class="smaller-number-font likert-hack">1</td>
                            <td class="smaller-number-font likert-hack">2</td>
                            <td class="smaller-number-font likert-hack">3</td>
                            <td class="smaller-number-font likert-hack">4</td>
                            <td class="smaller-number-font likert-hack">5</td>
                            <td class="smaller-number-font likert-hack">6</td>
                            <td class="smaller-number-font likert-hack">7</td>
                            <td></td>
                        </tr>
                        <tr>
                            <td class="smaller-font">Don't understand at all</td>
                            <td class="tr-background" style="border-radius:  5px 0 0 5px;">
                                <input type="radio" name="graph_understand" value="1">
                            </td>
                            <td class="tr-background">
                                <input type="radio" name="graph_understand" value="2">
                            </td>
                            <td class="tr-background">
                                <input type="radio" name="graph_understand" value="3">
                            </td>
                            <td class="tr-background">
                                <input type="radio" name="graph_understand" value="4">
                            </td>
                            <td class="tr-background">
                                <input type="radio" name="graph_understand" value="5">
                            </td>
                            <td class="tr-background">
                                <input type="radio" name="graph_understand" value="6">
                            </td>
                            <td class="tr-background" style="border-radius: 0 5px 5px 0;">
                                <input type="radio" name="graph_understand" value="7">
                            </td>
                            <td class="smaller-font likert-hack">Fully understand</td>
                        </tr>
                    </table>
                </td>
            </tr>
        </table>
    </div>

    <div class="high-separator"></div>
    <div class="high-separator"></div>

    <div id="div_learn_comment">
        <span class="question-header"> How much do you think you learned about classifying these instances by yourself?
        </span>
        <br>
        <textarea placeholder="max 1000 characters" name="learn_comment" class="form-control" maxlength="1000" id="learn_comment"
            type="text" cols="99" rows="6" style="resize:none;"></textarea>
    </div>


    <div class="high-separator"></div>
    <div class="high-separator"></div>

    <div id="div_trust_comment">
        <span class="question-header"> How did you adjust trust meter (when did you decide to decrease/increase your trust)?
        </span>
        <br>
        <textarea placeholder="max 1000 characters" name="trust_comment" class="form-control" maxlength="1000" id="trust_comment"
            type="text" cols="99" rows="6" style="resize:none;"></textarea>
    </div>

    <div class="high-separator"></div>
    <div class="high-separator"></div>

    <div id="div_vis_comment">
        <span class="question-header"> How did you compare different instances (what patterns did you look at)?
        </span>
        <br>
        <textarea placeholder="max 1000 characters" name="vis_comment" class="form-control" maxlength="1000" id="vis_comment" type="text"
            cols="99" rows="6" style="resize:none;"></textarea>
    </div>

    <div class="high-separator"></div>
    <div class="high-separator"></div>

    <div id="div_extra_comment">
        <span class="question-header"> Any additional comments?
        </span>
        <br>
        <textarea placeholder="max 1000 characters" name="extra_comment" class="form-control" maxlength="1000" id="extra_comment"
            type="text" cols="99" rows="6" style="resize:none;"></textarea>
    </div>

    <p class="warning container" id="questions-warning" style="visibility: hidden;">
        Please answer all the questions.
    </p>

    <a id="downloadAnchorElem" style="display:none"></a>

    <script>
        function downloadData() {
            var dataStr = "data:text/json;charset=utf-8," + encodeURIComponent(JSON.stringify(data));
            var dlAnchorElem = document.getElementById('downloadAnchorElem');
            var day = new Date()
            dlAnchorElem.setAttribute("href", dataStr);
            dlAnchorElem.setAttribute("download",
                "Classifiers-" + data.participantID + "-" + "E" + (data["experimentIndex"] + 1) + "-" +
                day.getFullYear() + "-" + (day.getMonth() + 1) + "-" + day.getDate() + "-" + new Date().getTime().toString(
                    16) + ".json");
            dlAnchorElem.click(); // fake a click 
        }

        (function () {
            d3.selectAll(".pid-eid").text(data["participantID"] + " " + "E" + (data["experimentIndex"] + 1))

            var imgNodes = d3.selectAll("img")["_groups"][0]

            imgNodes.forEach((n, i) => {
                d3.select(n)
                    .attr("src", n["name"] + "-" + data['currentDataset'] + ".png")
                    // .attr("width", "150px")
                    .attr("height", "150px")
            })

            experimentr.showNext()
            experimentr.release()

            //----------------------------------------------------------------------
            // when init, hide all the warning messages
            //----------------------------------------------------------------------
            d3.selectAll(".warning")
                .style("visibility", "hidden");

            data["timestamps"]["postQues"] = {}
            data["timestamps"]["postQues"]["loading"] = new Date().getTime();

            data["postQues"] = {}

            d3.select("#next-button")
                .on("click", () => {
                    let n1 = d3.select("input[name=liking_vis]:checked").node(),
                        n2 = d3.select("input[name=instance_comfortable]:checked").node(),
                        n31 = d3.select("input[name=tree_comfortable]:checked").node(),
                        n32 = d3.select("input[name=grid_comfortable]:checked").node(),
                        n33 = d3.select("input[name=graph_comfortable]:checked").node(),
                        n34 = d3.select("input[name=no_vis_comfortable]:checked").node(),
                        n41 = d3.select("input[name=tree_understand]:checked").node(),
                        n42 = d3.select("input[name=grid_understand]:checked").node(),
                        n43 = d3.select("input[name=graph_understand]:checked").node(),
                        n5 = d3.select("[name=learn_comment]").node(),
                        n6 = d3.select("[name=trust_comment]").node(),
                        n7 = d3.select("[name=vis_comment]").node(),
                        n8 = d3.select("[name=extra_comment]").node();

                    if ((n1 && n1.value != "" &&
                            n2 && n2.value != "" &&
                            n31 && n31.value != "" &&
                            n32 && n32.value != "" &&
                            n33 && n33.value != "" &&
                            n34 && n34.value != "" &&
                            n41 && n41.value != "" &&
                            n42 && n42.value != "" &&
                            n43 && n43.value != "" &&
                            n5 && n5.value != "" &&
                            n6 && n6.value != "" &&
                            n7 && n7.value != "") || globalDebug) {
                        data["postQues"]["liking_vis"] = n1 ? n1.value : -1;
                        data["postQues"]["instance_comfortable"] = n2 ? n2.value : -1;
                        data["postQues"]["tree_comfortable"] = n31 ? n31.value : -1;
                        data["postQues"]["grid_comfortable"] = n32 ? n32.value : -1;
                        data["postQues"]["graph_comfortable"] = n33 ? n33.value : -1;
                        data["postQues"]["no_vis_comfortable"] = n34 ? n34.value : -1;
                        data["postQues"]["tree_understand"] = n41 ? n41.value : -1;
                        data["postQues"]["grid_understand"] = n42 ? n42.value : -1;
                        data["postQues"]["graph_understand"] = n43 ? n43.value : -1;
                        data["postQues"]["learn_comment"] = n5 ? n5.value : -1;
                        data["postQues"]["trust_comment"] = n6 ? n6.value : -1;
                        data["postQues"]["vis_comment"] = n7 ? n7.value : -1;
                        data["postQues"]["extra_comment"] = n8 ? n8.value : -1;
                        data["timestamps"]["postQues"]["finishing"] = new Date().getTime();

                        data["timestamps"]["experimentEnd"] = new Date().getTime();

                        if (globalDebug) console.log(data)

                        downloadData()
                        experimentr.addData(data)
                        experimentr.next()

                    } else {
                        d3.selectAll(".warning")
                            .style("visibility", "visible");

                        setTimeout(() => {
                            d3.selectAll(".warning")
                                .style("visibility", "hidden")
                        }, data['settings']['warningTime'])

                        data["timestamps"]["postQues"]["warningTime"] = new Date().getTime();
                    } // end of else
                }) // end of next button

        }())
    </script>